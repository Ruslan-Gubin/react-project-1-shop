"use strict";(self.webpackChunkreact_webpack=self.webpackChunkreact_webpack||[]).push([[956],{6956:function(e,t,s){s.r(t),s.d(t,{default:function(){return d}});var a=s(7294),l=s(743),n=s(6974),o=s(4168),i=s(9910),r=s(2488),c=s(5893);const d=()=>{const{id:e}=(0,n.UO)(),{postUpdate:t}=(0,l.v9)(r.do),[s,{}]=i.Fv.useUpdatePostMutation(),[d,{}]=i.Fv.useCreatePostMutation(),[u,g]=a.useState(!1),[h,p]=a.useState(""),[f,x]=a.useState(""),[v,C]=a.useState(""),[j,k]=a.useState(""),{pathname:m}=(0,n.TH)(),b=(0,n.s0)(),w=a.useRef(null),S=(0,l.I0)(),{status:K}=(0,l.v9)(r.Hz);a.useEffect((()=>{K||b("/login")}),[K]);return a.useEffect((()=>{if(t&&"/add-post"!==m){const{text:e,title:s,image:a,tags:l}=t;p(e),x(s),C(l.join(",")),k(a.url)}}),[t]),(0,c.jsxs)("div",{className:"uGurd85tKSSerwHdjx4g",children:[(0,c.jsx)("div",{className:"Dd71k7xRBdSzsKMXIYU6",children:j?(0,c.jsx)(o.K1,{onClick:()=>k(""),bgColor:"red",children:"Удалить фото"}):(0,c.jsx)(o.K1,{onClick:()=>{var e;return null===(e=w.current)||void 0===e?void 0:e.click()},children:"Добавить фото"})}),(0,c.jsx)("input",{ref:w,type:"file",onChange:e=>{const t=!!e.target.files&&e.target.files[0];t&&(e=>{try{const t=new FileReader;t.readAsDataURL(e),t.onloadend=()=>{t.result&&k(t.result)}}catch(e){console.log(e,"Ошибка при загрузке файла!")}})(t)},hidden:!0}),j&&(0,c.jsx)("img",{className:"Jmjd5ECUROACJFlyml6W",src:j||"",alt:"uploaded"}),(0,c.jsx)(o.YF,{required:!0,value:f,onChange:e=>x(e),placeholder:"Заголовок..."}),(0,c.jsx)(o.YF,{required:!0,value:v,onChange:e=>C(e),placeholder:"Теги..."}),(0,c.jsx)(o.ML,{value:h,onChange:e=>p(e)}),""!==f&&""!==j&&""!==h&&""!==v?(0,c.jsx)(o.K1,{disabled:u,onClick:t=>(async t=>{g(!0),t.preventDefault();try{if(e)await s({text:h,title:f,tags:v,image:j,id:e}),j&&b(`/post/${e}`);else if(!e){const e=await d({text:h,title:f,tags:v,image:j}).unwrap();if(e._id){const t=e._id;b(`/post/${t}`)}}S(r.SI.setUpdatePostRemove())}catch(e){console.log("Ошибка при создании статьи",e)}})(t),children:"Опубликовать"}):(0,c.jsx)(o.K1,{bgColor:"black",children:"Заполните все поля !!!"}),(0,c.jsx)(o.K1,{onClick:()=>(h&&p(""),f&&x(""),v&&C(""),void(j&&k(""))),bgColor:"nobg",children:"Очистить"})]})}}}]);