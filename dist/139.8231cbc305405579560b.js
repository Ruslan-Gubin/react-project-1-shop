"use strict";(self.webpackChunkreact_webpack=self.webpackChunkreact_webpack||[]).push([[139],{9139:function(e,s,c){c.r(s),c.d(s,{default:function(){return f}});var i=c(7294),a=c(6706),l=c(5418),r={"test-p":"HHX3fYZQsIeGdwZVtfwH",root:"dDwuyFtTqGoYMoqNUKmM",CircleContainer:"dwGA77K5kTUnNFsONMuE",CircleValue:"ClW4oicTjLPN2UIqnN2P",CircleContainerActive:"lzDOfMXOzAEhbXANx8lQ"},n=c(5893);const t=e=>{let{updateActive:s,level:c,handlerClickCircle:i,mine:a}=e;return(0,n.jsx)("div",{className:r.container,children:a&&i&&s?(0,n.jsx)("div",{onClick:()=>i(a),className:`${r.rootActive} ${r.root}`,children:(0,n.jsx)("div",{className:`${r.CircleContainerActive} ${r.CircleContainer}`,children:(0,n.jsx)("div",{className:r.CircleValue,children:c})})}):(0,n.jsx)("div",{className:r.root,children:(0,n.jsx)("div",{className:r.CircleContainer,children:(0,n.jsx)("div",{className:r.CircleValue,children:c})})})})};c(2717),c(8232);var o=c(4042),d=c(3963),m=c(3939),u=c(7926),p={"test-p":"E6CHeT1ryvOa9IbZ0RSm",root:"kuQgkHfoL8aBVT_QXxBG",circle:"RjUSqzdTwUQP_5bFjtCH"};const h=e=>{let{mine:s,handlerIronValue:c,handlerClickCircle:l}=e;const{resurceBar:r}=(0,a.useSelector)(m.gr),{minesTargetRef:h}=(0,d.ct)(s,c),[v,x]=i.useState(!1);return i.useEffect((()=>{if(r){const e=(0,u.Vv)(s,r,o.Uv);x(e)}}),[r]),(0,n.jsxs)("div",{ref:h,className:p.root,children:[(0,n.jsx)("img",{className:p.image,src:s.imag,alt:"resorce field"}),(0,n.jsx)("div",{className:p.circle,children:s&&(0,n.jsx)(t,{handlerClickCircle:l,mine:s,updateActive:v,level:s.level})})]})};var v={root:"UepbnisyWSpsBJ1L_Fq8",mine:"eaFvpK7EvYXBvhpjTvkN"};const x=e=>{let{handlerIronValue:s,handlerClickCircle:c}=e;const{auth:i}=(0,a.useSelector)(m.Hz),{data:r,isLoading:t,refetch:o}=l.KD.useGetPlayerQuery({id:i._id});return(0,n.jsx)("div",{className:v.root,children:(0,n.jsx)("div",{className:v.mines,children:(0,n.jsx)("ul",{className:v.mine,children:r&&r.mines.map((e=>(0,n.jsx)("li",{children:(0,n.jsx)(h,{handlerIronValue:s,mine:e,handlerClickCircle:c})},e._id)))})})})};c(9384),c(4983);var j={root:"rykEgndP9wP_rcIG4ARW",container:"xPIdFK3hz2tMiwzHaRbs",title:"kZV3N09YgiX4JqXScmz_",text:"CvuXxlEEqZdI0LeVIQ6V",updateInfo:"zJaYCkqMEwsJKQbvYbYn",population:"VG7sYEJx0CL2zQt7mtVH",refreshIcon:"MgfATJ5DF79hPofKETSO",updateIcon:"hipPrRLHRtwPBtnHugyr",timeUpdate:"EyBaGTiL0_ZRrzTIG45f",icons:"vB82qpDHCxpJsvkb6ojm",resurce:"zHSoFXMicyz6v3AFnFLU",needResurce:"WmCiMRPuMiU3D1r6zMcc"};const N=()=>{const{lastMinesInfo:e,nextLevelMinesUpdate:s}=(0,a.useSelector)(m.gr),[c,l]=i.useState(e.level+1),[r,d]=i.useState(u.cp.dateEndUpdateFormat(s.time));return i.useEffect((()=>{l(e.level+1),d(u.cp.dateEndUpdateFormat(s.time))}),[e]),(0,n.jsx)("div",{className:j.root,children:(0,n.jsxs)("div",{className:j.container,children:[(0,n.jsx)("h2",{className:j.title,children:e.title}),(0,n.jsx)("p",{className:j.text,children:"Увеличение производства"}),(0,n.jsxs)("div",{className:j.updateInfo,children:[(0,n.jsx)("div",{className:j.level,children:(0,n.jsx)(t,{level:e.level,updateActive:!1})}),(0,n.jsxs)("div",{className:j.population,children:[(0,n.jsx)("img",{src:o.Kc.population,alt:"icon population"}),(0,n.jsx)("span",{children:e.piple})]}),(0,n.jsx)("div",{className:j.incom,children:(0,n.jsxs)("span",{children:[e.income,"/ч"]})}),(0,n.jsx)("div",{className:j.refreshIcon,children:(0,n.jsx)("img",{src:o.Kc.refresh,alt:"refresh icon"})}),(0,n.jsx)("div",{className:j.incom,children:(0,n.jsxs)("span",{children:[s.income,"/ч"]})}),(0,n.jsxs)("div",{className:j.population,children:[(0,n.jsx)("img",{src:o.Kc.population,alt:"icon population"}),(0,n.jsx)("span",{children:s.piple})]}),(0,n.jsx)("div",{className:j.nextLevel,children:(0,n.jsx)(t,{level:c,updateActive:!1})})]}),(0,n.jsxs)("div",{className:j.timeUpdate,children:[(0,n.jsx)("img",{src:o.Kc.clock,alt:"icon clock"}),(0,n.jsxs)("span",{children:["Время строительства:",u.cp.vievDate(s.time)]})]}),(0,n.jsx)("div",{className:j.endUpdateDate,children:(0,n.jsxs)("span",{children:["Завершится строительство в: ",r]})}),(0,n.jsxs)("div",{className:j.icons,children:[(0,n.jsxs)("div",{className:j.resurce,children:[(0,n.jsx)("img",{src:o.Kc.wood,alt:"Icon resurce"}),(0,n.jsx)("span",{className:j.needResurce,children:s.wood})]}),(0,n.jsxs)("div",{className:j.resurce,children:[(0,n.jsx)("img",{src:o.Kc.clay,alt:"Icon resurce"}),(0,n.jsx)("span",{className:j.needResurce,children:s.clay})]}),(0,n.jsxs)("div",{className:j.resurce,children:[(0,n.jsx)("img",{src:o.Kc.iron,alt:"Icon resurce"}),(0,n.jsx)("span",{className:j.needResurce,children:s.iron})]}),(0,n.jsxs)("div",{className:j.resurce,children:[(0,n.jsx)("img",{src:o.Kc.wheat,alt:"Icon resurce"}),(0,n.jsx)("span",{className:j.needResurce,children:s.wheat})]})]})]})})};var C={"test-p":"iGnbOP_GQFQVFErfESkl"},w=c(2804);const f=()=>{const{auth:e}=(0,a.useSelector)(m.Hz),{nextLevelMinesUpdate:s,player:c,resurceBar:i}=(0,a.useSelector)(m.gr),{data:r}=l.KD.useGetPlayerQuery({id:e._id}),[t,{}]=l.KD.useUpdateLevelMineMutation(),[d,{}]=l.KD.useUpdateLevelMineFullMutation(),p=(0,a.useDispatch)();return(0,n.jsxs)("div",{className:C.root,children:[(0,n.jsx)(w.K1,{onClick:()=>(async()=>{await d("")})(),width:200,bgColor:"black",children:"full"}),(0,n.jsx)(N,{}),(0,n.jsx)(x,{handlerClickCircle:async e=>{if(console.log(e),r){const a={wood:i.wood-s.wood,clay:i.clay-s.clay,iron:i.iron-s.iron,wheat:i.wheat-s.wheat},l={level:s.level,income:s.income,piple:s.piple,time:s.time,population:s.piple-e.piple,resurce:e.resorse,incrementIncome:s.income-e.income,playerId:c._id,idMine:e._id,resurceBar:a,resurceBarAfterUpdate:{wood:(0,u.WJ)(a.wood,r.income.wood,s.time,r.capasity.wood),clay:(0,u.WJ)(a.clay,r.income.clay,s.time,r.capasity.clay),iron:(0,u.WJ)(a.iron,r.income.iron,s.time,r.capasity.iron),wheat:(0,u.WJ)(a.wheat,r.income.wheat,s.time,r.capasity.wheat)}};await t(l).unwrap().then((e=>{const s=e.resourceBar;p(m.xH.setResurceBarAll(s))})).catch((e=>console.log(e)))}},handlerIronValue:e=>{if(e){const s=e.resorse,c=e.level;p(m.xH.setLastMinesInfo(e));const i=(0,u.rP)(o.Uv,s,c+1);p(m.xH.setNextLevelMineUpdate(i))}}})]})}}}]);