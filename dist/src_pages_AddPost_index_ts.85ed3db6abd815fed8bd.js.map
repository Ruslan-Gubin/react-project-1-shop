{"version":3,"file":"src_pages_AddPost_index_ts.85ed3db6abd815fed8bd.js","mappings":"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","sources":["webpack://react-webpack/./src/pages/AddPost/AddPost.tsx","webpack://react-webpack/./src/pages/AddPost/index.ts","webpack://react-webpack/./src/pages/AddPost/AddPost.module.scss","webpack://react-webpack/./src/pages/AddPost/AddPost.module.scss?8f3d"],"sourcesContent":["import React from 'react';\r\nimport { useDispatch, useSelector } from 'react-redux';\r\nimport {  useLocation, useNavigate, useParams } from 'react-router-dom';\r\nimport * as ui from 'ui';\r\nimport { postApi } from 'store/rtkQuery';\r\nimport { postAction, selectAuth, selectPosts } from 'store/slice';\r\nimport styles from './AddPost.module.scss';\r\n\r\nconst AddPost = () => {\r\n  const { id } = useParams<string>();\r\n  const {postUpdate} = useSelector(selectPosts) \r\n  const [updatePost, {}] = postApi.useUpdatePostMutation();\r\n  const [createPost, {}] = postApi.useCreatePostMutation();\r\n  const [disabled, setDisabled] = React.useState(false);\r\n  \r\n  const [text, setText] = React.useState(\"\");\r\n  const [title, setTitle] = React.useState(\"\");\r\n  const [tags, setTags] = React.useState('');\r\n  const [image, setImage] = React.useState<string>('');\r\n \r\n \r\n  const {pathname} = useLocation()\r\n  const navigate = useNavigate();\r\n  const inputFileRef = React.useRef<HTMLInputElement>(null);\r\n  const dispatch = useDispatch()\r\n  const { status } = useSelector(selectAuth);\r\n\r\n  React.useEffect(() => {\r\n    if (!status) navigate(\"/login\");\r\n  }, [status]);\r\n\r\n  const handlerChangeFile = (e: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = e.target.files ? e.target.files[0] : false;\r\n    file && setFileToBase(file);\r\n  };\r\n\r\n  const setFileToBase = (file: File) => {\r\n    try {\r\n      const render = new FileReader();\r\n      render.readAsDataURL(file);\r\n      render.onloadend = () => {\r\n        if (render.result) {\r\n          setImage(render.result);\r\n        }\r\n      };\r\n    } catch (error) {\r\n      console.log(error, \"Ошибка при загрузке файла!\");\r\n    }\r\n  };\r\n\r\n  const onSubmitAddPost = async (\r\n    event: React.MouseEvent<HTMLButtonElement>\r\n  ) => {\r\n    setDisabled(true)\r\n    event.preventDefault();\r\n    try {\r\n      if (id  ) {\r\n        await updatePost({ text, title, tags, image, id })\r\n        .unwrap()\r\n        .catch(error => console.log(error))\r\n        image && navigate(`/post/${id}`);\r\n      } else if (!id && image) {\r\n         await createPost({ text, title, tags, image })\r\n        .unwrap()\r\n        .then(data => {\r\n          const track = data._id;\r\n          navigate(`/post/${track}`);\r\n        })\r\n        .catch(error => console.log(error))\r\n      }\r\n      dispatch(postAction.setUpdatePostRemove())\r\n    } catch (error) {\r\n      console.log(\"Ошибка при создании статьи\", error);\r\n    }\r\n  };\r\n\r\n  React.useEffect(() => {\r\n    if (postUpdate  &&  pathname !== '/add-post') {\r\n        const { text, title, image, tags } = postUpdate;\r\n        setText(text);\r\n        setTitle(title);\r\n        setTags(tags.join(\",\"));\r\n        setImage(image.url);\r\n      }\r\n  }, [postUpdate]);\r\n\r\n  const handlerClear = () => {\r\n    if (text) setText(\"\");\r\n    if (title) setTitle(\"\");\r\n    if (tags) setTags('');\r\n    if (image) setImage(\"\");\r\n  };\r\n  \r\n  return (\r\n    <div className={styles.root}>\r\n    <div className={styles.buttonImage}>\r\n      {image ? (\r\n        <ui.ButtonMain onClick={() => setImage(\"\")} bgColor=\"red\">\r\n          Удалить фото\r\n        </ui.ButtonMain>\r\n      ) : (\r\n        <ui.ButtonMain onClick={() => inputFileRef.current?.click()}>\r\n          Добавить фото\r\n        </ui.ButtonMain>\r\n      )}\r\n    </div>\r\n    <input\r\n      ref={inputFileRef}\r\n      type=\"file\"\r\n      onChange={handlerChangeFile}\r\n      hidden\r\n    />\r\n    {image && (\r\n      <img\r\n        className={styles.previewImage}\r\n        src={image ? image : \"\"}\r\n        alt=\"uploaded\"\r\n      />\r\n    )}\r\n    <ui.InputMain\r\n      required={true}\r\n      value={title}\r\n      onChange={(value) => setTitle(value)}\r\n      placeholder=\"Заголовок...\"\r\n    />\r\n    <ui.InputMain\r\n      required={true}\r\n      value={tags}\r\n      onChange={(value) => setTags(value)}\r\n      placeholder=\"Теги...\"\r\n    />\r\n    <ui.Editor value={text} onChange={(value) => setText(value)} />\r\n    {title !== \"\" && image !== \"\" && text !== \"\" && tags !== \"\" ? \r\n      <ui.ButtonMain disabled={disabled} onClick={(event) => onSubmitAddPost(event)}>\r\n        Опубликовать\r\n      </ui.ButtonMain>\r\n      : <ui.ButtonMain bgColor=\"black\">Заполните все поля !!!</ui.ButtonMain>\r\n    }\r\n    <ui.ButtonMain onClick={() => handlerClear()} bgColor=\"nobg\">\r\n      Очистить\r\n    </ui.ButtonMain>\r\n  </div>\r\n  );\r\n};\r\n\r\nexport {AddPost};","export {AddPost as default} from './AddPost';","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, \".uGurd85tKSSerwHdjx4g {\\n  font-family: \\\"Gilroy-Medium\\\";\\n}\\n.uGurd85tKSSerwHdjx4g .Dd71k7xRBdSzsKMXIYU6 {\\n  display: block;\\n}\\n.uGurd85tKSSerwHdjx4g .Jmjd5ECUROACJFlyml6W {\\n  width: 100%;\\n  height: 500px;\\n  border-radius: 0.7em;\\n}\", \"\",{\"version\":3,\"sources\":[\"webpack://./src/pages/AddPost/AddPost.module.scss\",\"webpack://./src/scss/common/var/fonts.scss\",\"webpack://./src/scss/common/var/borderRadius.scss\"],\"names\":[],\"mappings\":\"AAEA;EACE,4BCKiB;ADNnB;AAEE;EACE,cAAA;AAAJ;AAGE;EACE,WAAA;EACA,aAAA;EACA,oBENkB;AFKtB\",\"sourcesContent\":[\"@use '../../scss/common/var';\\r\\n\\r\\n.root {\\r\\n  font-family: var.$ff-Gilroy-Medium;\\r\\n  .buttonImage {\\r\\n    display: block;\\r\\n  }\\r\\n\\r\\n  .previewImage {\\r\\n    width: 100%;\\r\\n    height: 500px;\\r\\n    border-radius: var.$border-radius-small;\\r\\n  }\\r\\n}\",\"$ff-montserrat-bold: 'Montserrat';\\r\\n$ff-montserrat-regular: 'Montserrat-regular';\\r\\n\\r\\n$ff-BebasNeue-Regular: 'BebasNeue-Regular';\\r\\n\\r\\n$ff-Gilroy-Bold: 'Gilroy-Bold';\\r\\n$ff-Gilroy-Heavy: 'Gilroy-Heavy';\\r\\n$ff-Gilroy-Light: 'Gilroy-Light';\\r\\n$ff-Gilroy-Medium: 'Gilroy-Medium';\\r\\n$ff-Gilroy-Regular: 'Gilroy-Regular';\\r\\n\\r\\n\\r\\n\\r\\n\\r\\n// thin 100\\r\\n// light 300\\r\\n// regular 400\\r\\n// medium 500\\r\\n// bold 700\\r\\n// black 900\\r\\n\",\"\\r\\n$border-radius: 3px;\\r\\n$border-radius-circle: 50%;\\r\\n$border-radius-button: 0.5em;\\r\\n$border-radius-average: 1em;\\r\\n$border-radius-small: .7em;\\r\\n\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\n___CSS_LOADER_EXPORT___.locals = {\n\t\"root\": \"uGurd85tKSSerwHdjx4g\",\n\t\"buttonImage\": \"Dd71k7xRBdSzsKMXIYU6\",\n\t\"previewImage\": \"Jmjd5ECUROACJFlyml6W\"\n};\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./AddPost.module.scss\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\n\n      options.insert = insertFn.bind(null, \"head\");\n    \noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../node_modules/css-loader/dist/cjs.js!../../../node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[2].use[2]!../../../node_modules/sass-loader/dist/cjs.js!./AddPost.module.scss\";\n       export default content && content.locals ? content.locals : undefined;\n"],"names":["React","useDispatch","useSelector","useLocation","useNavigate","useParams","ui","postApi","postAction","selectAuth","selectPosts","styles","AddPost","id","postUpdate","updatePost","useUpdatePostMutation","createPost","useCreatePostMutation","disabled","setDisabled","useState","text","setText","title","setTitle","tags","setTags","image","setImage","pathname","navigate","inputFileRef","useRef","dispatch","status","useEffect","handlerChangeFile","e","file","target","files","setFileToBase","render","FileReader","readAsDataURL","onloadend","result","error","console","log","onSubmitAddPost","event","preventDefault","unwrap","catch","then","data","track","_id","setUpdatePostRemove","join","url","handlerClear","root","buttonImage","current","click","previewImage","value","default"],"sourceRoot":""}